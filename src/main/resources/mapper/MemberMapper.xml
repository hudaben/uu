<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.carryit.base.besttmwuu.dao.MemberDao">


	<select id="getMemberById" resultType="com.carryit.base.besttmwuu.entity.Member"
		parameterType="Integer">
		<!-- select b.levelname levelName from ims_ewei_shop_member a left join 
			ims_ewei_shop_member_level b on a.level = b.level where a.uid = #{uid}
			select id,avatar,realName,city,nickName from ims_ewei_shop_member m where 
			id = #{uid} -->
		SELECT a.id,avatar,realName,city,nickName,b.levelname levelName,zhuquanzi FROM
		ims_ewei_shop_member a LEFT JOIN ims_ewei_shop_member_level b ON
		a.level = b.level WHERE a.uid = #{uid}
	</select>


	<select id="getWealthById" resultType="com.carryit.base.besttmwuu.entity.Member"
		parameterType="Integer">
		select credit2,credit1 from ims_ewei_shop_member where id = #{uid}

	</select>

	<select id="getMemberByUIdAndLevel" resultType="int">
		select COUNT(*) from ims_ewei_shop_member where zhuquanzi = #{zhuquanzi} and level = #{level}

	</select>

	<update id="updateMemberByUIdAndLevel">
		update ims_ewei_shop_member set
		level = #{level}
		where uid = #{uid}
	</update>

	<select id="getnormalMember" resultType="com.carryit.base.besttmwuu.entity.Member">
		select m.id,m.realname,m.avatar,m.nickname,m.level,b.levelname,(select sum(o.price) from ims_ewei_shop_order o where o.uid=m.uid and o.createtime >=#{startTime} and o.createtime &lt;=#{endTime}) credit2
		from ims_ewei_shop_member m
		LEFT JOIN ims_ewei_shop_member_level b ON m.level = b.level
		where m.zhuquanzi =#{zhuquanzi} and m.level not in("0","6","7") order by credit2 desc

	</select>

	<select id="getnormalMemberCount" resultType="long">
		select count(*)
		from ims_ewei_shop_member
		where zhuquanzi =#{zhuquanzi} and level not in("0","6","7")

	</select>

	<select id="getadminMember" resultType="com.carryit.base.besttmwuu.entity.Member">
		select m.id,m.realname,m.avatar,m.nickname,m.level,b.levelname,(select sum(o.price) from ims_ewei_shop_order o where o.uid=m.uid and o.createtime >=#{startTime} and o.createtime &lt;=#{endTime}) credit2
		from ims_ewei_shop_member m
		LEFT JOIN ims_ewei_shop_member_level b ON m.level = b.level
		where m.zhuquanzi =#{zhuquanzi} and m.level in("0","6","7") order by credit2 desc

	</select>

	<select id="getadminMemberCount" resultType="long">
		select count(*)
		from ims_ewei_shop_member
		where zhuquanzi =#{zhuquanzi} and level in("0","6","7")

	</select>


</mapper>